<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A√ßƒ±k Kaynaklƒ± ƒ∞ngilizce Geli≈ütirme Programƒ± v2 (Web)</title>
    <!-- Tailwind CSS CDN - Sadece temel stil i√ßin -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Genel stil ayarlarƒ± */
        body {
            font-family: 'Inter', sans-serif;
            color: #333;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* √úste hizala */
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1000px; /* PyQt5 uygulamasƒ±nƒ±n geni≈üliƒüine yakƒ±n */
            overflow: hidden;
        }
        .tab-button {
            padding: 12px 24px;
            border: 1px solid #ccc;
            border-bottom: none;
            border-radius: 6px 6px 0 0;
            margin-right: 4px;
            background-color: #f7f7f7;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        .tab-button.active {
            background-color: #ffffff;
            border-bottom: 2px solid #28a745;
            color: #28a745;
        }
        .tab-content {
            padding: 20px;
            border-top: 2px solid #C2C2C2;
        }
        .scroll-area {
            max-height: 400px; /* PyQt5 scroll area y√ºksekliƒüi sim√ºlasyonu */
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 4px;
            padding: 10px;
            background-color: #fdfdfd;
        }
        input[type="text"], textarea, select {
            border: 1px solid #ccc;
            border-radius: 6px;
            padding: 8px;
            background-color: #fdfdfd;
            width: 100%;
            box-sizing: border-box; /* Padding'i geni≈üliƒüe dahil et */
        }
        input[type="text"]:focus, textarea:focus, select:focus {
            border-color: #28a745;
            outline: none;
        }
        button {
            background-color: #28a745;
            color: white;
            padding: 10px 18px;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: background-color 0.3s ease;
            cursor: pointer;
        }
        button:hover {
            background-color: #218838;
        }
        .grid-layout {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); /* Dinamik s√ºtunlar */
            gap: 10px;
        }
        .word-item {
            display: flex;
            align-items: center;
            gap: 8px; /* √ñƒüeler arasƒ±ndaki bo≈üluk */
            font-size: 1.13rem; /* Yazƒ± boyutu (bir tƒ±k daha b√ºy√ºk) */
        }
        .word-item input[type="checkbox"] {
            transform: scale(1.6); /* Kutucuk boyutu (bir tƒ±k daha b√ºy√ºk) */
        }

        /* Modal Stilleri */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fefefe;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 400px;
            text-align: center;
            position: relative;
        }
        .modal-content h3 {
            margin-bottom: 20px;
            color: #333;
        }
        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .modal-buttons button {
            width: 100%;
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 6px;
        }
        .close-button {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }
        .close-button:hover {
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="flex border-b border-gray-200">
            <button class="tab-button active" onclick="showTab('selector-tab')">Oxford Kelime Se√ßici</button>
            <button class="tab-button" onclick="showTab('editor-tab')">Liste D√ºzenleyici ve √áevirmen</button>
        </div>

        <!-- Oxford Kelime Se√ßici Sekmesi -->
        <div id="selector-tab" class="tab-content">
            <div class="flex flex-wrap items-center gap-4 mb-4">
                <select id="selector-level-combo" class="p-2 border rounded-md">
                    <option value="A1">A1</option>
                    <option value="A2">A2</option>
                    <option value="B1">B1</option>
                    <option value="B2">B2</option>
                </select>
                <button id="selector-view-button" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-md">Izgara</button>
                <select id="selector-filter-combo" class="p-2 border rounded-md">
                    <option value="Hepsini G√∂ster">Hepsini G√∂ster</option>
                    <option value="Se√ßilenleri G√∂ster">Se√ßilenleri G√∂ster</option>
                    <option value="Se√ßilmeyenleri G√∂ster">Se√ßilmeyenleri G√∂ster</option>
                </select>
                <button id="selector-toggle-button">Hepsini Se√ß</button>
                <input type="text" id="selector-search-box" placeholder="Kelime, anlam, t√ºr veya seviye arayƒ±n..." class="flex-grow max-w-xs">
            </div>
            <div id="selector-status-label" class="mb-4 text-gray-600">Se√ßilenler: Hen√ºz yok</div>
            <div id="selector-scroll-area" class="scroll-area mb-4">
                <div id="selector-words-container">
                    <!-- Kelimeler buraya y√ºklenecek -->
                </div>
            </div>
            <div class="flex justify-between items-center">
                <button id="selector-export-btn">Se√ßilen Kelimeleri Dƒ±≈üa Aktar</button>
                <button id="send-to-editor-btn">Se√ßilenleri √áeviri Listesine G√∂nder</button>
            </div>
        </div>

        <!-- Liste D√ºzenleyici ve √áevirmen Sekmesi -->
        <div id="editor-tab" class="tab-content hidden">
            <div class="border p-4 rounded-md mb-4 bg-gray-50">
                <h3 class="text-lg font-bold mb-2 text-green-800">üì• Kelime Listesini Yapƒ±≈ütƒ±rƒ±n veya Dosya Y√ºkleyin</h3>
                <textarea id="editor-input-area" rows="6" placeholder="Her satƒ±ra bir kelime gelecek ≈üekilde yazƒ±n veya yapƒ±≈ütƒ±rƒ±n..." class="mb-2"></textarea>
                <div class="flex gap-2">
                    <!-- Dosya y√ºkleme i√ßin gizli input -->
                    <input type="file" id="file-upload-input" accept=".txt,.csv" class="hidden">
                    <button id="editor-load-file-btn" class="bg-blue-500 hover:bg-blue-600">üìÅ Dosya Y√ºkle (.txt)</button>
                    <button id="editor-load-text-btn">üì§ Listeye Y√ºkle</button>
                </div>
            </div>

            <div id="editor-scroll-area" class="scroll-area mb-4">
                <div id="editor-words-container">
                    <!-- D√ºzenlenebilir kelimeler buraya y√ºklenecek -->
                </div>
            </div>

            <div class="flex justify-between items-center gap-2">
                <button id="editor-add-btn" class="bg-gray-500 hover:bg-gray-600 px-4 py-2 text-xl leading-none">‚ûï</button>
                <button id="editor-remove-btn" class="bg-gray-500 hover:bg-gray-600 px-4 py-2 text-xl leading-none">‚ûñ</button>
                <span class="flex-grow"></span>
                <button id="editor-refresh-btn">‚ü≥ √áevir (Sim√ºle)</button>
                <button id="editor-export-btn-main">0 OLU≈ûTUR</button>
            </div>
        </div>
    </div>

    <!-- Modallar -->
    <div id="selectorExportModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('selectorExportModal')">&times;</span>
            <h3>√áƒ±ktƒ± Formatƒ± Se√ßin</h3>
            <div class="modal-buttons">
                <button onclick="selectorExportPlain(); closeModal('selectorExportModal')">Metin (Sade Liste)</button>
                <button onclick="selectorExportGrouped(); closeModal('selectorExportModal')">Liste (Gruplandƒ±rƒ±lmƒ±≈ü)</button>
                <button onclick="showMessage('Bilgi', 'Bu √∂zellik ≈üu anda geli≈ütirme a≈üamasƒ±ndadƒ±r.'); closeModal('selectorExportModal')">Excel (Hazƒ±rlanƒ±yor)</button>
            </div>
        </div>
    </div>

    <div id="editorExportModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('editorExportModal')">&times;</span>
            <h3>Dosya Olu≈ütur</h3>
            <div class="modal-buttons">
                <button onclick="editorExportTxt(editorGetCurrentWords()); closeModal('editorExportModal')">Metin (Sade Liste)</button>
                <button onclick="editorExportPdf(editorGetCurrentWords()); closeModal('editorExportModal')">PDF (Sim√ºle)</button>
                <button onclick="showMessage('Bilgi', '\'Excel\' formatƒ± ≈üu anda hazƒ±rlƒ±k a≈üamasƒ±ndadƒ±r.'); closeModal('editorExportModal')">Excel (Hazƒ±rlanƒ±yor)</button>
            </div>
        </div>
    </div>

    <script>
        // Uzun kelime listesinin bulunduƒüu internet sitesinin linki buraya gelecek
        // CORS hatasƒ±nƒ± a≈ümak i√ßin corsproxy.io kullanƒ±ldƒ±. Kendi GitHub HTML URL'nizi encodeURIComponent() i√ßine yapƒ±≈ütƒ±rƒ±n.
        // √ñrneƒüin: 'https://corsproxy.io/?' + encodeURIComponent('https://github.com/kullaniciadi/repoadi/blob/main/kelimeler.html')
        // DEƒûƒ∞≈ûTƒ∞Rƒ∞LDƒ∞: Artƒ±k doƒürudan JSON dosyasƒ± okunacak, corsproxy ihtiyacƒ± kalmayacak.
        const EXTERNAL_WORD_LIST_URL = 'https://raw.githubusercontent.com/dudukdev1ren/hesaplayicipuani/refs/heads/main/liste-v2.2.json'; // Bu URL'yi kendi JSON dosyanƒ±zƒ±n URL'siyle deƒüi≈ütirin.

        // Deneme i√ßin kullanƒ±lan yedek mini liste
        const FALLBACK_OXFORD_WORDS = [
            {"w": "Error", "p": "v.", "l": "B1", "m": "terk etmek"},
            {"w": "Error", "p": "adj.", "l": "A2", "m": "yapabilen, yetenekli"},
            {"w": "Error", "p": "prep., n.", "l": "A1", "m": "yukarƒ±da"},
            {"w": "Error", "p": "adv.", "l": "B2", "m": "yurt dƒ±≈üƒ±nda"},
            {"w": "accept", "p": "v.", "l": "A2", "m": "kabul etmek"},
            {"w": "access", "p": "n., v.", "l": "B1", "m": "eri≈üim, eri≈ümek"},
            {"w": "accident", "p": "n.", "l": "A2", "m": "kaza"},
            {"w": "account", "p": "n., v.", "l": "B1", "m": "hesap, a√ßƒ±klamak"},
            {"w": "achieve", "p": "v.", "l": "B1", "m": "ba≈üarmak"},
            {"w": "across", "p": "prep., adv.", "l": "A2", "m": "kar≈üƒ±dan kar≈üƒ±ya"}
        ];

        let OXFORD_WORDS = []; // Bu, URL'den veya yedek listeden doldurulacak ana kelime listesi

        // Uygulama durumu deƒüi≈ükenleri
        let selectedWordsByLevel = { "A1": new Set(), "A2": new Set(), "B1": new Set(), "B2": new Set() };
        let currentWordLevel = "A1";
        let gridMode = false;
        let editorWordFields = []; // Edit√∂rdeki kelime giri≈ü alanlarƒ±nƒ± tutar

        // Hƒ±zlƒ± arama i√ßin kelime anlamlarƒ± s√∂zl√ºƒü√º (initializeWordList i√ßinde doldurulacak)
        let wordMeanings = {};

        // =================================================================
        // Genel Yardƒ±mcƒ± Fonksiyonlar
        // =================================================================

        // Mesaj kutusu g√∂stermek i√ßin basit bir sim√ºlasyon (alert kullanƒ±ldƒ±)
        function showMessage(title, message) {
            alert(`${title}\n\n${message}`);
        }

        // Modal'ƒ± a√ß
        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        // Modal'ƒ± kapat
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // =================================================================
        // Kelime Listesini Y√ºkleme (URL'den veya Yedekten)
        // =================================================================

        async function initializeWordList() {
            console.log('Kelime listesi URL\'den y√ºklenmeye √ßalƒ±≈üƒ±lƒ±yor...');
            try {
                const response = await fetch(EXTERNAL_WORD_LIST_URL);
                if (!response.ok) {
                    throw new Error(`HTTP hatasƒ±! Durum: ${response.status}`);
                }

                const data = await response.json(); // Doƒürudan JSON olarak ayrƒ±≈ütƒ±r

                // Basit doƒürulama: Verinin bir dizi olup olmadƒ±ƒüƒ±nƒ± ve beklenen √∂zellikleri i√ßerip i√ßermediƒüini kontrol et
                if (Array.isArray(data) && data.length > 0 && data[0].w && data[0].l) {
                    OXFORD_WORDS = data;
                    console.log(`URL'den ${OXFORD_WORDS.length} kelime ba≈üarƒ±yla y√ºklendi.`);
                } else {
                    throw new Error('√áekilen veri beklenen JSON dizi formatƒ±nda deƒüil veya bo≈ü.');
                }

            } catch (error) {
                console.error('URL\'den kelime listesi y√ºklenemedi, yedek liste kullanƒ±lƒ±yor:', error);
                OXFORD_WORDS = FALLBACK_OXFORD_WORDS;
                console.log(`Yedek liste kullanƒ±lƒ±yor: ${OXFORD_WORDS.length} kelime.`);
            }

            // OXFORD_WORDS kesinle≈ütiƒüinde wordMeanings'i doldur
            wordMeanings = {};
            OXFORD_WORDS.forEach(wordData => {
                if (wordData.m) {
                    wordMeanings[wordData.w.toLowerCase()] = wordData.m;
                }
            });

            // Kelime listesi hazƒ±r olduƒüunda UI'ya y√ºklemeyi ba≈ülat
            selectorLoadLevelWords();
        }

        // =================================================================
        // Sekme Y√∂netimi
        // =================================================================

        function showTab(tabId) {
            // T√ºm sekme i√ßeriklerini gizle
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            // T√ºm sekme butonlarƒ±nƒ±n aktif sƒ±nƒ±fƒ±nƒ± kaldƒ±r
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
                button.classList.add('bg-gray-200', 'text-gray-800'); // Pasif stil
                button.classList.remove('bg-white', 'text-green-700'); // Aktif stil
            });

            // Se√ßilen sekme i√ßeriƒüini g√∂ster
            document.getElementById(tabId).classList.remove('hidden');
            // Se√ßilen sekme butonunu aktif yap
            const activeButton = document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`);
            if (activeButton) {
                activeButton.classList.add('active');
                activeButton.classList.remove('bg-gray-200', 'text-gray-800'); // Pasif stil
                activeButton.classList.add('bg-white', 'text-green-700'); // Aktif stil
            }

            // Sekme deƒüi≈ütiƒüinde ilgili verileri y√ºkle/g√ºncelle
            if (tabId === 'selector-tab') {
                selectorLoadLevelWords();
            } else if (tabId === 'editor-tab') {
                editorUpdateWordCount();
            }
        }

        // =================================================================
        // Kelime Se√ßici Sekmesi Fonksiyonlarƒ±
        // =================================================================

        function selectorSetLevel() {
            currentWordLevel = document.getElementById('selector-level-combo').value;
            selectorLoadLevelWords();
        }

        function selectorToggleViewMode() {
            gridMode = !gridMode;
            const viewButton = document.getElementById('selector-view-button');
            viewButton.textContent = gridMode ? "Liste" : "Izgara";
            selectorLoadLevelWords();
        }

        function selectorLoadLevelWords() {
            const filterMode = document.getElementById('selector-filter-combo').value;
            const searchText = document.getElementById('selector-search-box').value.toLowerCase().trim();
            const wordsContainer = document.getElementById('selector-words-container');
            wordsContainer.innerHTML = ''; // √ñnceki kelimeleri temizle

            let filteredWords = [];
            let wordsForCurrentLevel = [];

            // Arama metni varsa t√ºm kelimelerden ara, yoksa sadece se√ßili seviyeden
            if (searchText) {
                OXFORD_WORDS.forEach(w => {
                    if (w.w.toLowerCase().includes(searchText) ||
                        (w.m && w.m.toLowerCase().includes(searchText)) ||
                        (w.p && w.p.toLowerCase().includes(searchText)) ||
                        (w.l && w.l.toLowerCase().includes(searchText))) {
                        wordsForCurrentLevel.push(w);
                    }
                });
            } else {
                wordsForCurrentLevel = OXFORD_WORDS.filter(w => w.l === currentWordLevel);
            }

            // Filtreleme uygula
            wordsForCurrentLevel.forEach(wordData => {
                const isSelected = selectedWordsByLevel[wordData.l] && selectedWordsByLevel[wordData.l].has(wordData.w);
                if (filterMode === "Hepsini G√∂ster") {
                    filteredWords.push(wordData);
                } else if (filterMode === "Se√ßilenleri G√∂ster" && isSelected) {
                    filteredWords.push(wordData);
                } else if (filterMode === "Se√ßilmeyenleri G√∂ster" && !isSelected) {
                    filteredWords.push(wordData);
                }
            });

            // Konteynerin layoutunu ayarla
            wordsContainer.className = gridMode ? 'grid-layout' : 'flex flex-col';

            filteredWords.forEach(wordData => {
                const div = document.createElement('div');
                div.className = 'word-item';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `cb-${wordData.l}-${wordData.w}`;
                checkbox.checked = selectedWordsByLevel[wordData.l] && selectedWordsByLevel[wordData.l].has(wordData.w);
                checkbox.onchange = (event) => selectorUpdateStatusForWord(wordData, event.target.checked);

                const label = document.createElement('label');
                label.htmlFor = checkbox.id;
                label.textContent = wordData.w;

                div.appendChild(checkbox);
                div.appendChild(label);
                wordsContainer.appendChild(div);
            });

            selectorUpdateStatusDisplay();
        }

        function selectorUpdateStatusForWord(wordData, isChecked) {
            const level = wordData.l;
            const word = wordData.w;

            if (!selectedWordsByLevel[level]) {
                selectedWordsByLevel[level] = new Set();
            }

            if (isChecked) {
                selectedWordsByLevel[level].add(word);
            } else {
                selectedWordsByLevel[level].delete(word);
            }
            selectorUpdateStatusDisplay();
        }

        function selectorToggleSelection() {
            const checkboxes = document.querySelectorAll('#selector-words-container input[type="checkbox"]');
            if (checkboxes.length === 0) return;

            const allSelected = Array.from(checkboxes).every(cb => cb.checked);
            const newState = !allSelected;

            checkboxes.forEach(cb => {
                cb.checked = newState;
                // Durumu manuel olarak g√ºncelle
                const [_, level, word] = cb.id.split('-'); // id'den kelime ve seviyeyi √ßƒ±kar
                const wordData = OXFORD_WORDS.find(w => w.w === word && w.l === level);
                if (wordData) {
                    selectorUpdateStatusForWord(wordData, newState);
                }
            });
            selectorUpdateStatusDisplay();
        }

        function selectorUpdateStatusDisplay() {
            const statusLabel = document.getElementById('selector-status-label');
            let statusParts = [];
            let totalCount = 0;
            ["A1", "A2", "B1", "B2"].forEach(level => {
                const count = selectedWordsByLevel[level] ? selectedWordsByLevel[level].size : 0;
                if (count > 0) {
                    statusParts.push(`${level}:${count}`);
                    totalCount += count;
                }
            });
            if (statusParts.length === 0) {
                statusLabel.textContent = "Se√ßilenler: Hen√ºz yok";
            } else {
                statusLabel.textContent = `Toplam Se√ßilen: ${totalCount} (${statusParts.join(' / ')})`;
            }
        }

        function selectorShowExportDialog() {
            let totalSelected = 0;
            for (const level in selectedWordsByLevel) {
                totalSelected += selectedWordsByLevel[level].size;
            }

            if (totalSelected === 0) {
                showMessage("Uyarƒ±", "Dƒ±≈üa aktarmak i√ßin √∂nce en az bir kelime se√ßmelisiniz.");
                return;
            }
            openModal('selectorExportModal');
        }

        function downloadTextFile(filename, content) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function selectorExportPlain() {
            let allWords = [];
            ["A1", "A2", "B1", "B2"].forEach(level => {
                if (selectedWordsByLevel[level]) {
                    allWords.push(...Array.from(selectedWordsByLevel[level]).sort());
                }
            });
            const content = allWords.join("\n");
            downloadTextFile("secilmis_kelimeler.txt", content);
            showMessage("Ba≈üarƒ±lƒ±", "Sade metin dosyasƒ± ba≈üarƒ±yla olu≈üturuldu ve indirildi.");
        }

        function selectorExportGrouped() {
            let content = "";
            ["A1", "A2", "B1", "B2"].forEach(level => {
                const selectedInLevel = selectedWordsByLevel[level];
                if (selectedInLevel && selectedInLevel.size > 0) {
                    content += `=== ${level} ===\n`;
                    const wordsWithPos = OXFORD_WORDS.filter(w => selectedInLevel.has(w.w));
                    const groupedByPos = {};
                    wordsWithPos.forEach(w => {
                        if (!groupedByPos[w.p]) groupedByPos[w.p] = [];
                        groupedByPos[w.p].push(w.w);
                    });
                    Object.keys(groupedByPos).sort().forEach(pos => {
                        content += `--- ${pos} ---\n`;
                        groupedByPos[pos].sort().forEach(word => {
                            content += word + "\n";
                        });
                        content += "\n";
                    });
                }
            });
            downloadTextFile("gruplanmis_kelimeler.txt", content);
            showMessage("Ba≈üarƒ±lƒ±", "Gruplanmƒ±≈ü metin dosyasƒ± ba≈üarƒ±yla olu≈üturuldu ve indirildi.");
        }

        // =================================================================
        // Liste D√ºzenleyici ve √áevirmen Sekmesi Fonksiyonlarƒ±
        // =================================================================

        function editorLoadFromTextarea() {
            const rawText = document.getElementById('editor-input-area').value;
            const words = rawText.split('\n').map(word => word.trim()).filter(word => word);
            if (words.length === 0) return;

            editorClearWordFields();
            words.forEach(word => {
                editorAddWordField(word);
            });
            document.getElementById('editor-input-area').value = ''; // Temizle
        }

        function editorLoadFromFile() {
            const fileInput = document.getElementById('file-upload-input');
            fileInput.click(); // Gizli dosya inputunu tetikle

            fileInput.onchange = (e) => {
                const file = e.target.files[0];
                if (!file) {
                    showMessage("Uyarƒ±", "Dosya se√ßilmedi.");
                    return;
                }

                const reader = new FileReader();
                reader.onload = (event) => {
                    const content = event.target.result;
                    document.getElementById('editor-input-area').value = content;
                    editorLoadFromTextarea(); // Metin alanƒ±na y√ºklenen i√ßeriƒüi i≈üle
                    showMessage("Ba≈üarƒ±lƒ±", "Dosya i√ßeriƒüi ba≈üarƒ±yla y√ºklendi.");
                };
                reader.onerror = () => {
                    showMessage("Hata", "Dosya okunamadƒ±.");
                };
                reader.readAsText(file);
            };
        }

        function editorUpdateWordCount() {
            const count = editorWordFields.length;
            document.getElementById('editor-export-btn-main').textContent = `${count} OLU≈ûTUR`;
        }

        function editorClearWordFields() {
            const container = document.getElementById('editor-words-container');
            container.innerHTML = '';
            editorWordFields = [];
            editorUpdateWordCount();
        }

        function editorAddWordField(word = '', meaning = '') {
            const container = document.getElementById('editor-words-container');
            const index = editorWordFields.length + 1;

            const div = document.createElement('div');
            div.className = 'flex items-center gap-2 mb-2';

            const label = document.createElement('span');
            label.textContent = `${index}.`;
            label.className = 'w-8 text-right';

            const wordInput = document.createElement('input');
            wordInput.type = 'text';
            wordInput.value = word;
            wordInput.placeholder = 'Kelime';
            wordInput.className = 'flex-grow';

            const meaningInput = document.createElement('input');
            meaningInput.type = 'text';
            meaningInput.value = meaning;
            meaningInput.placeholder = 'Anlam';
            meaningInput.className = 'flex-grow';

            div.appendChild(label);
            div.appendChild(wordInput);
            div.appendChild(meaningInput);
            container.appendChild(div);

            editorWordFields.push({ element: div, wordInput: wordInput, meaningInput: meaningInput });
            editorUpdateWordCount();
        }

        function editorRemoveLastField() {
            if (editorWordFields.length > 0) {
                const field = editorWordFields.pop();
                field.element.remove(); // HTML elementini DOM'dan kaldƒ±r
                editorUpdateWordCount();
            }
        }

        function editorRefreshTranslations() {
            if (editorWordFields.length === 0) return;

            for (const field of editorWordFields) {
                const wordToTranslate = field.wordInput.value.trim();
                if (wordToTranslate && !field.meaningInput.value.trim()) {
                    const foundMeaning = wordMeanings[wordToTranslate.toLowerCase()];
                    if (foundMeaning) {
                        field.meaningInput.value = foundMeaning;
                    } else {
                        // Basit bir gecikme sim√ºlasyonu
                        // Ger√ßek bir √ßeviri API'si burada kullanƒ±lmalƒ±
                        field.meaningInput.value = `(√áeviri: ${wordToTranslate})`; // Sim√ºle edilmi≈ü √ßeviri
                    }
                }
            }
            showMessage("Ba≈üarƒ±lƒ±", "√áeviriler g√ºncellendi (sim√ºle edildi).");
        }

        function editorGetCurrentWords() {
            const words = [];
            editorWordFields.forEach(field => {
                const word = field.wordInput.value.trim();
                const meaning = field.meaningInput.value.trim();
                if (word) {
                    words.push({ word: word, meaning: meaning });
                }
            });
            return words;
        }

        function editorShowExportPopup() {
            const wordsToExport = editorGetCurrentWords();
            if (wordsToExport.length === 0) {
                showMessage("Uyarƒ±", "Dƒ±≈üa aktarƒ±lacak kelime bulunamadƒ±.");
                return;
            }
            openModal('editorExportModal');
        }

        function downloadTextFile(filename, content) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function editorExportTxt(words) {
            let content = "";
            words.forEach(item => {
                content += `${item.word}:${item.meaning}\n`;
            });
            downloadTextFile("ozel_liste.txt", content);
            showMessage("Ba≈üarƒ±lƒ±", `${words.length} kelimelik metin dosyasƒ± olu≈üturuldu ve indirildi.`);
        }

        function editorExportPdf(words) {
            // PDF olu≈üturma web'de karma≈üƒ±k bir konudur.
            // jsPDF gibi k√ºt√ºphaneler kullanƒ±labilir ancak Python'daki FPDF kadar kolay olmayabilir.
            // Bu bir sim√ºlasyondur.
            showMessage("Bilgi", "PDF olu≈üturma web tarayƒ±cƒ±sƒ±nda doƒürudan desteklenmez. Bu bir sim√ºlasyondur. Ger√ßek uygulamada bir sunucu tarafƒ± √ß√∂z√ºm√º veya istemci tarafƒ± PDF k√ºt√ºphanesi (√∂rn. jsPDF) kullanƒ±lmalƒ±dƒ±r.");
            const content = words.map(item => `${item.word}: ${item.meaning}`).join('\n');
            downloadTextFile("kelime_listesi.txt", `(PDF ƒ∞√ßeriƒüi Sim√ºlasyonu)\n\n${content}`); // PDF yerine TXT indir
        }

        // =================================================================
        // Sekmeler Arasƒ± ƒ∞leti≈üim
        // =================================================================

        function sendSelectedToEditor() {
            let allSelectedWords = [];
            ["A1", "A2", "B1", "B2"].forEach(level => {
                if (selectedWordsByLevel[level]) {
                    allSelectedWords.push(...Array.from(selectedWordsByLevel[level]).sort());
                }
            });

            if (allSelectedWords.length === 0) {
                showMessage("Uyarƒ±", "Listeye g√∂ndermek i√ßin √∂nce kelime se√ßmelisiniz.");
                return;
            }

            editorClearWordFields();
            allSelectedWords.forEach(word => {
                editorAddWordField(word);
            });
            showTab('editor-tab'); // Edit√∂r sekmesine ge√ß
            showMessage("Ba≈üarƒ±lƒ±", `${allSelectedWords.length} kelime listeye aktarƒ±ldƒ±.`);
        }

        // =================================================================
        // Uygulama Ba≈ülangƒ±cƒ±
        // =================================================================

        document.addEventListener('DOMContentLoaded', () => {
            // ƒ∞lk sekmeyi g√∂ster
            showTab('selector-tab');

            // Kelime listesini y√ºkle (URL'den veya yedekten)
            initializeWordList(); // Bu fonksiyon, kelimeler y√ºklendikten sonra selectorLoadLevelWords'u √ßaƒüƒ±racak

            // Olay dinleyicilerini ata
            document.getElementById('selector-level-combo').addEventListener('change', selectorSetLevel);
            document.getElementById('selector-filter-combo').addEventListener('change', selectorLoadLevelWords);
            document.getElementById('selector-search-box').addEventListener('input', selectorLoadLevelWords);

            // Butonlara olay dinleyicileri ekle
            document.getElementById('selector-view-button').addEventListener('click', selectorToggleViewMode);
            document.getElementById('selector-toggle-button').addEventListener('click', selectorToggleSelection);
            document.getElementById('selector-export-btn').addEventListener('click', selectorShowExportDialog);
            document.getElementById('send-to-editor-btn').addEventListener('click', sendSelectedToEditor);

            // Dosya y√ºkleme i√ßin yeni input ve buton baƒülantƒ±sƒ±
            document.getElementById('editor-load-file-btn').addEventListener('click', editorLoadFromFile);
            document.getElementById('editor-load-text-btn').addEventListener('click', editorLoadFromTextarea);
            document.getElementById('editor-add-btn').addEventListener('click', editorAddWordField);
            document.getElementById('editor-remove-btn').addEventListener('click', editorRemoveLastField);
            document.getElementById('editor-refresh-btn').addEventListener('click', editorRefreshTranslations);
            document.getElementById('editor-export-btn-main').addEventListener('click', editorShowExportPopup);
        });
    </script>
</body>
</html>
